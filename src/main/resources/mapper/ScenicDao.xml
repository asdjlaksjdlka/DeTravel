<?xml version="1.0" encoding="UTF-8" ?>

<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.qf.detravel.dao.ScenicDao">
    <resultMap id="scenicMap" type="com.qf.detravel.vo.ScenicVo">
        <id column="s_id" property="sId"></id>
        <result column="s_name" property="sName"></result>
        <result column="s_region" property="sRegion"></result>
        <result column="s_country" property="sCountry"></result>
        <result column="s_desc" property="sDesc"></result>
        <result column="s_history" property="sHistory"></result>
        <result column="v_id" property="vId"></result>
        <collection property="photos" ofType="com.qf.detravel.entity.Photo">
            <id column="p_id" property="pId"></id>
            <result column="p_url" property="pUrl"></result>
            <result column="s_id" property="sId"></result>
        </collection>
    </resultMap>
    <resultMap id="scenicsMap" type="com.qf.detravel.entity.Scenic">
        <id column="s_id" property="sId"></id>
        <result column="s_name" property="sName"></result>
        <result column="s_region" property="sRegion"></result>
        <result column="s_country" property="sCountry"></result>
        <result column="s_desc" property="sDesc"></result>
        <result column="s_history" property="sHistory"></result>
        <result column="v_id" property="vId"></result>
        <result column="p_url" property="pUrl"></result>
    </resultMap>

    <select id="findAllScenic" resultMap="scenicsMap">
        select s_country, s_name, p_url from t_scenic where v_id = #{vId} and s_region = #{sRegion}
    </select>

    <select id="findAllByCountry" resultMap="scenicsMap">
        select s_country, s_name, p_url from t_scenic where v_id = #{vId} and s_region = #{sRegion} and s_country = #{sCountry}
    </select>

    <select id="findCountryCount" resultType="map">
        SELECT COUNT(*) as number, s_country FROM t_scenic WHERE v_id = #{vId} and s_region =#{sRegion} and s_country = #{sCountry}
    </select>

    <select id="findScenic" resultMap="scenicMap">
        select s_desc, s_history, p_url from t_scenic where v_id = #{vId} and s_name = #{sName} and
        s_region =#{sRegion} and s_country = #{sCountry}
    </select>
</mapper>